!function(t){t.fn.llskala=function(r){var n,a,h,e,d,o,i,g,u,M,l,x,p,w,c,r=t.extend({bleed:!1,margin:0,align:"center",valign:"center"},r);n=t(this),a=n.width(),h=n.height(),M=a/h,r.bleed?(g=Math.floor(a),u=Math.floor(h)):(g=Math.round(a)-2*r.margin,u=Math.round(h)-2*r.margin),o=n.children(),o.each(function(){i=t(this),e=i.attr("data-org-width")?i.attr("data-org-width"):Math.round(i.width()),d=i.attr("data-org-height")?i.attr("data-org-height"):Math.round(i.height()),l=e/d,c={left:0,top:0},r.bleed?(M>=1?l>=1?(rw=e/a,rh=d/h,rw>rh?(x=h/d,p=Math.round(e*x),w=u):(x=a/e,w=Math.round(d*x),w=h>w?h+2:w,p=g)):(x=a/e,w=Math.round(d*x),w=h>w?h+2:w,p=g):l>=1?(x=h/d,p=Math.round(e*x),p=a>p?a+2:p,w=u):(rw=e/g,rh=d/u,rw>rh?(x=h/d,p=Math.round(e*x),w=u):(x=a/e,w=Math.round(d*x),p=g)),"center"==r.align?p>a&&t.extend(c,{left:"-"+Math.round((p-a)/2)+"px"}):"right"==r.align&&p>a&&t.extend(c,{left:"-"+(Math.round(p-a)-r.margin)+"px"}),"center"==r.valign?w>h&&t.extend(c,{top:"-"+Math.round((w-h)/2)+"px"}):"bottom"==r.valign&&w>h&&t.extend(c,{top:"-"+(Math.round(w-h)-r.margin)+"px"})):(M>=1?l>=1?(rw=e/g,rh=d/u,rw>rh?(x=g/e,w=Math.round(d*x),p=g):(x=u/d,p=Math.round(e*x),w=u)):(x=u/d,p=Math.round(e*x),w=u):l>=1?(x=g/e,w=Math.round(d*x),p=g):(rw=e/g,rh=d/u,rw>rh?(x=g/e,w=Math.round(d*x),p=g):(x=u/d,p=Math.round(e*x),w=u)),"center"==r.align?a>=p&&t.extend(c,{left:Math.round((a-p)/2)+"px"}):"right"==r.align&&a>=p&&t.extend(c,{left:Math.round(a-p)-r.margin+"px"}),"center"==r.valign?h>=w&&t.extend(c,{top:Math.round((h-w)/2)+"px"}):"bottom"==r.valign&&h>=w&&t.extend(c,{top:Math.round(h-w)-r.margin+"px"})),i.width(p).height(w).css(c)})}}(jQuery);